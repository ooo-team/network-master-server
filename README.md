# Network Master Server

## Описание

Этот проект — простой in-memory web-сервер на Go для управления комнатами (rooms) с возможностью создавать, просматривать, присоединять клиентов и удалять комнаты. Все данные хранятся только в оперативной памяти, база данных не используется.

## Запуск

1. Установите Go (https://golang.org/dl/)
2. Клонируйте репозиторий и перейдите в папку проекта.
3. Установите зависимости:
   ```bash
   go mod tidy
   ```
4. Запустите сервер:
   ```bash
   # Запуск на порту по умолчанию (5312)
   go run main.go

   # Запуск на указанном порту
   go run main.go -port 8080
   ```

## API

### 1. Создать комнату
**POST** `/v1/rooms?max_clients=<int>`

- **Параметры:**
  - `max_clients` — максимальное количество клиентов (целое число)
- **IP-адрес хоста:**
  - Определяется автоматически из `RemoteAddr` запроса
- **Ответ:**
  - `200 OK`
  - JSON: `{ "room_id": "<uuid>" }`
- **Пример запроса:**
  ```bash
  curl -X POST "http://localhost:8080/v1/rooms?max_clients=4"
  ```

### 2. Присоединить клиента к комнате
**PUT** `/v1/rooms?room_id=<uuid>`

- **Параметры:**
  - `room_id` — UUID комнаты
- **IP-адрес клиента:**
  - Определяется автоматически из `RemoteAddr` запроса
- **Ответ:**
  - `200 OK` — если клиент успешно добавлен
  - `403 Forbidden` — если в комнате нет мест
  - `404 Not Found` — если комната не найдена
- **Пример запроса:**
  ```bash
  curl -X PUT "http://localhost:8080/v1/rooms?room_id=<uuid>"
  ```

### 3. Удалить комнату
**DELETE** `/v1/rooms?room_id=<uuid>`

- **Параметры:**
  - `room_id` — UUID комнаты
- **Требование:**
  - Запрос должен идти от IP-адреса, совпадающего с `host` комнаты (определяется из `RemoteAddr`)
- **Ответ:**
  - `200 OK` — если комната удалена
  - `403 Forbidden` — если удаляет не хост
  - `404 Not Found` — если комната не найдена
- **Пример запроса:**
  ```bash
  curl -X DELETE "http://localhost:8080/v1/rooms?room_id=<uuid>"
  ```

### 4. Получить информацию о комнатах
**GET** `/v1/rooms` или `/v1/rooms?room_id=<uuid>`

- **Параметры:**
  - `room_id` (опционально) — UUID комнаты
- **Ответ:**
  - Если `room_id` указан: JSON с объектом комнаты
  - Если не указан: JSON-массив всех комнат
- **Пример запроса (все комнаты):**
  ```bash
  curl "http://localhost:8080/v1/rooms"
  ```
- **Пример запроса (конкретная комната):**
  ```bash
  curl "http://localhost:8080/v1/rooms?room_id=<uuid>"
  ```

## Формат объекта Room
```json
{
  "id": "<uuid>",
  "host": "<ip>",
  "max_clients": <int>,
  "clients": ["<ip>", ...]
}
```

## Тестирование

Для запуска интеграционных тестов:
```bash
go test -v
```
Тесты покрывают:
- создание комнаты
- просмотр комнаты
- присоединение клиента
- удаление комнаты (с проверкой прав)
- просмотр всех комнат

## Примечания
- Все данные хранятся только в памяти процесса Go. После перезапуска сервера все комнаты будут утеряны.
- IP-адреса клиентов определяются автоматически из `RemoteAddr` запроса.
- Сервер не реализует аутентификацию и не предназначен для продакшена.

---

**Автор:**
- Telegram: @dimoha_zadira
- GitHub: https://github.com/dimoha-zadira

