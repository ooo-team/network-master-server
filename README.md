# Network Master Server

Сервер для управления сетевыми комнатами. Позволяет создавать комнаты, присоединяться к ним и управлять списком клиентов.

## API Endpoints

### Создание комнаты
```
POST /v1/rooms?max_clients=<number>
```
- `max_clients` (обязательный): максимальное количество клиентов в комнате
- Возвращает `room_id` созданной комнаты

### Получение информации о комнате
```
GET /v1/rooms?room_id=<id>
```
- `room_id` (обязательный): ID комнаты
- Возвращает информацию о комнате в формате:
```json
{
  "id": "string",
  "host": "string",
  "max_clients": number,
  "clients": ["string"]
}
```

### Получение списка всех комнат
```
GET /v1/rooms
```
- Возвращает массив всех комнат

### Присоединение к комнате
```
PUT /v1/rooms?room_id=<id>
```
- `room_id` (обязательный): ID комнаты
- Возвращает статус присоединения

### Удаление комнаты
```
DELETE /v1/rooms?room_id=<id>
```
- `room_id` (обязательный): ID комнаты
- Только хост комнаты может её удалить

## Поддержка IP адресов

Сервер поддерживает как IPv4, так и IPv6 адреса. IP адрес клиента определяется в следующем порядке:

1. Заголовок `X-Real-IP` (если запрос идет через прокси)
2. Заголовок `X-Forwarded-For` (если запрос идет через цепочку прокси)
3. `RemoteAddr` (при прямом подключении)

Примеры IP адресов:
- IPv4: `192.168.1.1`
- IPv6: `2001:db8::1`

## Запуск сервера

```bash
go run main.go
```

По умолчанию сервер запускается на порту 5312. Порт можно изменить с помощью флага `-port`:

```bash
go run main.go -port 8080
```

## Тестирование

```bash
go test -v
```

## Примеры использования

### Создание комнаты
```bash
curl -X POST "http://localhost:5312/v1/rooms?max_clients=4"
```

### Получение информации о комнате
```bash
curl "http://localhost:5312/v1/rooms?room_id=<room_id>"
```

### Присоединение к комнате
```bash
curl -X PUT "http://localhost:5312/v1/rooms?room_id=<room_id>"
```

### Удаление комнаты
```bash
curl -X DELETE "http://localhost:5312/v1/rooms?room_id=<room_id>"
```

### Получение списка всех комнат
```bash
curl "http://localhost:5312/v1/rooms"
```

## Описание

Этот проект — простой in-memory web-сервер на Go для управления комнатами (rooms) с возможностью создавать, просматривать, присоединять клиентов и удалять комнаты. Все данные хранятся только в оперативной памяти, база данных не используется.

## Формат объекта Room
```json
{
  "id": "<uuid>",
  "host": "<ip>",
  "max_clients": <int>,
  "clients": ["<ip>", ...]
}
```

## Тестирование

Для запуска интеграционных тестов:
```bash
go test -v
```
Тесты покрывают:
- создание комнаты
- просмотр комнаты
- присоединение клиента
- удаление комнаты (с проверкой прав)
- просмотр всех комнат

## Примечания
- Все данные хранятся только в памяти процесса Go. После перезапуска сервера все комнаты будут утеряны.
- IP-адреса клиентов определяются автоматически из `RemoteAddr` запроса.
- Сервер не реализует аутентификацию и не предназначен для продакшена.

---

**Автор:**
- Telegram: @dimoha_zadira
- GitHub: https://github.com/dimoha-zadira

